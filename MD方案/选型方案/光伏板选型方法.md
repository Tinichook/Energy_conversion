# 光伏组件选型方法

## 一、原报告问题分析

原报告直接给定了744W和1488W两种功率规格的光伏板，存在以下问题：
1. **缺乏需求分析**：未说明为什么需要这两种功率
2. **选型依据不足**：没有从负荷需求出发进行计算
3. **设备匹配缺失**：未与设备库中的光伏板型号进行对比选择
4. **计算过程不完整**：缺少必要的公式推导

## 二、光伏组件选型的正确流程

### 2.1 选型流程图

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ 1.负荷需求  │───▶│ 2.资源评估  │───▶│ 3.容量计算  │───▶│ 4.组件选型  │
│   分析      │    │  (辐照度)   │    │  (装机容量) │    │  (型号匹配) │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                                │
┌─────────────┐    ┌─────────────┐    ┌─────────────┐          │
│ 7.方案确定  │◀───│ 6.经济比选  │◀───│ 5.发电量    │◀─────────┘
│             │    │             │    │   验算      │
└─────────────┘    └─────────────┘    └─────────────┘
```

### 2.2 第一步：负荷需求分析

首先需要明确项目的用电需求：

| 参数 | 符号 | 单位 | 说明 |
|------|------|------|------|
| 日用电量 | $E_{load}$ | kWh/d | 项目每日用电需求 |
| 光伏供电比例 | $\alpha$ | % | 光伏发电占总用电的比例 |
| 光伏日发电需求 | $E_{pv,need}$ | kWh/d | 光伏系统需要提供的电量 |

$$E_{pv,need} = E_{load} \times \alpha$$

### 2.3 第二步：太阳能资源评估

通过气象数据获取当地的太阳辐射资源：

| 参数 | 符号 | 单位 | 说明 |
|------|------|------|------|
| 总水平辐照度 | $G_T$ | kWh/m²/d | 日均太阳辐射量 |
| 峰值日照时数 | $H_{peak}$ | h | 等效满功率发电时数 |
| 环境温度 | $T$ | °C | 当地平均气温 |

**峰值日照时数计算：**

$$H_{peak} = \frac{G_T}{G_{STC}}$$

其中 $G_{STC} = 1 \text{ kW/m}^2$ 为标准测试条件下的光照强度。

### 2.4 第三步：装机容量计算

**光伏系统装机容量计算公式：**

$$P_{pv} = \frac{E_{pv,need}}{H_{peak} \times \eta_{sys}}$$

其中：
- $P_{pv}$ — 光伏系统装机容量 (kWp)
- $E_{pv,need}$ — 日发电需求 (kWh/d)
- $H_{peak}$ — 峰值日照时数 (h)
- $\eta_{sys}$ — 系统综合效率

**系统综合效率：**

$$\eta_{sys} = \eta_{pv} \times \eta_{inv} \times \eta_{cable} \times \eta_{dust} \times \eta_{mismatch}$$

| 效率因子 | 符号 | 典型值 | 说明 |
|----------|------|--------|------|
| 组件效率修正 | $\eta_{pv}$ | 0.90-0.95 | 温度、衰减影响 |
| 逆变器效率 | $\eta_{inv}$ | 0.96-0.98 | 逆变器转换效率 |
| 线缆损耗 | $\eta_{cable}$ | 0.97-0.99 | 直流/交流线损 |
| 灰尘遮挡 | $\eta_{dust}$ | 0.95-0.98 | 灰尘积累影响 |
| 组件失配 | $\eta_{mismatch}$ | 0.97-0.99 | 组件参数差异 |

**典型系统效率：** $\eta_{sys} \approx 0.80 \sim 0.85$

### 2.5 第四步：组件选型与数量计算

**组件数量计算：**

$$N = \frac{P_{pv}}{P_{module}}$$

其中：
- $N$ — 组件数量 (块)
- $P_{pv}$ — 系统装机容量 (Wp)
- $P_{module}$ — 单块组件标称功率 (Wp)

**可选组件型号（来自设备库）：**

| 型号 | 类型 | 标称功率 | 效率 | 尺寸(mm) | Voc | Isc | 参考价格 |
|------|------|----------|------|----------|-----|-----|----------|
| PV-330M | 单晶硅 | 330 Wp | 20.1% | 1956×992×40 | 40.5V | 10.2A | 650-750元 |
| PV-450M | 单晶硅 | 450 Wp | 20.7% | 2094×1038×35 | 49.5V | 11.4A | 850-950元 |
| PV-550M | 单晶硅 | 550 Wp | 21.3% | 2278×1134×35 | 49.8V | 13.9A | 1000-1150元 |
| PV-600M | 单晶硅 | 600 Wp | 21.8% | 2384×1134×35 | 51.8V | 14.6A | 1150-1300元 |
| PV-280P | 多晶硅 | 280 Wp | 17.2% | 1956×992×40 | 38.2V | 9.2A | 500-600元 |

## 三、温度修正与实际发电功率计算

### 3.1 温度对组件效率的影响

光伏组件的实际输出功率受温度影响，需要进行修正：

**电池工作温度计算：**

$$T_{cell} = T_{amb} + \frac{NOCT - 20}{800} \times G$$

其中：
- $T_{cell}$ — 电池工作温度 (°C)
- $T_{amb}$ — 环境温度 (°C)
- $NOCT$ — 标称工作温度，通常为45°C
- $G$ — 实际辐照度 (W/m²)

**温度修正后的效率：**

$$\eta_{mp} = \eta_{mp,STC} \times (1 + \alpha_p \times (T_{cell} - 25))$$

其中：
- $\eta_{mp,STC}$ — 标准测试条件下的效率
- $\alpha_p$ — 功率温度系数，典型值为 -0.35%/°C 至 -0.45%/°C

### 3.2 实际发电功率计算

**单块组件实际输出功率：**

$$P_{pv,actual} = P_{module} \times \frac{G}{G_{STC}} \times (1 + \alpha_p \times (T_{cell} - 25)) \times f_{pv}$$

其中：
- $P_{module}$ — 组件标称功率 (Wp)
- $G$ — 实际辐照度 (W/m²)
- $G_{STC}$ — 标准辐照度 = 1000 W/m²
- $\alpha_p$ — 功率温度系数
- $f_{pv}$ — 降额因子（考虑污染、老化等），通常取0.90-0.95

### 3.3 日发电量计算

**单块组件日发电量：**

$$E_{day} = \sum_{i=1}^{24} P_{pv,actual,i} \times \Delta t$$

或简化为：

$$E_{day} = P_{module} \times H_{peak} \times \eta_{sys}$$

## 四、选型计算示例

### 4.1 项目条件

假设某农业区项目：
- 日用电量：$E_{load} = 240$ MWh/d
- 光伏供电比例：$\alpha = 30\%$
- 日均辐照度：$G_T = 4.5$ kWh/m²/d（十月份数据）
- 平均气温：$T_{amb} = 12°C$

### 4.2 计算过程

**Step 1：光伏日发电需求**

$$E_{pv,need} = 240 \times 30\% = 72 \text{ MWh/d} = 72000 \text{ kWh/d}$$

**Step 2：峰值日照时数**

$$H_{peak} = \frac{4.5}{1} = 4.5 \text{ h}$$

**Step 3：系统综合效率**

$$\eta_{sys} = 0.92 \times 0.97 \times 0.98 \times 0.96 \times 0.98 = 0.823$$

**Step 4：装机容量**

$$P_{pv} = \frac{72000}{4.5 \times 0.823} = 19443 \text{ kWp} \approx 19.5 \text{ MWp}$$

**Step 5：组件选型比较**

| 组件型号 | 单价(元/Wp) | 所需数量(块) | 总投资(万元) | 占地面积(m²) |
|----------|-------------|--------------|--------------|--------------|
| PV-330M | 2.12 | 58918 | 4131 | 114,300 |
| PV-450M | 2.00 | 43222 | 3889 | 93,900 |
| PV-550M | 1.95 | 35351 | 3886 | 91,400 |
| PV-600M | 2.04 | 32417 | 3955 | 87,700 |

**Step 6：选型结论**

综合考虑单位成本、占地面积和安装便利性，推荐选用 **PV-550M** 型组件：
- 单块功率：550 Wp
- 所需数量：35,351 块
- 总装机容量：19.44 MWp
- 总投资：约3886万元

### 4.3 发电量验算

**温度修正计算：**

以十月份平均温度12°C为例：

$$T_{cell} = 12 + \frac{45-20}{800} \times 800 = 37°C$$

$$\eta_{temp} = 1 + (-0.35\%) \times (37 - 25) = 0.958$$

**日发电量验算：**

$$E_{day} = 19443 \times 4.5 \times 0.823 = 71,987 \text{ kWh} \approx 72 \text{ MWh}$$

满足设计需求 ✓

## 五、组件串并联设计

### 5.1 组串设计原则

根据逆变器MPPT电压范围确定组串长度：

$$N_{series,min} = \frac{V_{MPPT,min}}{V_{mp} \times (1 + \beta_{Voc} \times (T_{max} - 25))}$$

$$N_{series,max} = \frac{V_{MPPT,max}}{V_{oc} \times (1 + \beta_{Voc} \times (T_{min} - 25))}$$

其中：
- $V_{MPPT,min/max}$ — 逆变器MPPT电压范围
- $V_{mp}$ — 组件最大功率点电压
- $V_{oc}$ — 组件开路电压
- $\beta_{Voc}$ — 电压温度系数，约-0.30%/°C

### 5.2 以PV-550M为例

组件参数：$V_{oc} = 49.8V$，$V_{mp} \approx 41V$

配套逆变器INV-110K：MPPT电压范围200-1100V

假设工作温度范围：-10°C ~ 60°C

$$N_{series,min} = \frac{200}{41 \times (1 - 0.003 \times 35)} = 5.5 \rightarrow 6 \text{块}$$

$$N_{series,max} = \frac{1100}{49.8 \times (1 - 0.003 \times (-35))} = 19.9 \rightarrow 19 \text{块}$$

**推荐组串配置：** 每串16-18块组件

## 六、选型总结

### 6.1 正确的选型流程

1. **明确需求** → 确定日发电量目标
2. **资源评估** → 获取当地辐照度数据
3. **容量计算** → 计算所需装机容量
4. **型号比选** → 对比设备库中的组件
5. **发电验算** → 验证是否满足需求
6. **串并联设计** → 确定组件连接方式

### 6.2 原报告的改进建议

原报告中直接给出744W和1488W的做法不合理，应该：

1. 先根据负荷需求计算所需装机容量
2. 从设备库中选择合适的组件型号（如PV-550M）
3. 计算所需组件数量
4. 进行发电量验算
5. 如需要不同功率配置，应说明原因（如屋顶限制、分区安装等）

**注：** 744W和1488W可能是某种组合配置（如2块330W或4块372W），但报告中应明确说明组合方式和选择依据。
