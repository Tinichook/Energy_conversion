# 风光生物质储能混合系统优化模型

## 目标函数与约束条件汇总

---

## 一、目标函数

### 1.1 综合评分目标函数（四维评分体系）

$$\max \ S_{total} = S_{condition} + S_{equipment} + S_{economy} + S_{stability}$$

式中：
- $S_{condition}$ —— 工况满足评分，满分30分
- $S_{equipment}$ —— 设备匹配评分，满分20分
- $S_{economy}$ —— 经济性评分，满分30分
- $S_{stability}$ —— 稳定性评分，满分20分

### 1.2 转换为最小化问题

$$\min \ F = 100 - S_{total}$$

### 1.3 各维度评分计算

#### (1) 工况满足评分（30分）

$$S_{condition} = S_{load} + S_{ratio} + S_{balance}$$

- 负荷满足评分：$S_{load} = 12 \times \left(1 - \frac{LPSP}{LPSP_{max}}\right)$
- 能源占比评分：$S_{ratio} = 10 \times \left(1 - \frac{\sum_{i}|k_i - k_{i,target}|}{k_{tolerance}}\right)$
- 功率平衡评分：$S_{balance} = 8 \times \left(1 - \frac{T_{deficit}}{8760}\right)$

#### (2) 设备匹配评分（20分）

$$S_{equipment} = S_{inv} + S_{PCS} + S_{cap}$$

- 逆变器匹配评分：$S_{inv} = 7 \times f_{inv}(k_{inv})$
- PCS匹配评分：$S_{PCS} = 7 \times f_{PCS}(k_{PCS})$
- 容量配置评分：$S_{cap} = 6 \times f_{cap}(R_{ESS})$

#### (3) 经济性评分（30分）

$$S_{economy} = 30 \times \left(1 - \frac{C_{total}}{C_{max}}\right)$$

**总投资计算（设备投资成本相加）：**

$C_{total} = C_{wind} + C_{solar} + C_{bio} + C_{ESS}$

各部分投资：
- 风电投资：$C_{wind} = \sum_i N_{wind,i} \times c_{wind,i}$
- 光伏投资：$C_{solar} = \sum_j N_{solar,j} \times c_{solar,j} + \sum_q N_{inv,q} \times c_{inv,q}$
- 生物质投资：$C_{bio} = \sum_k N_{bio,k} \times c_{bio,k}$
- 储能投资：$C_{ESS} = \sum_m N_{batt,m} \times c_{batt,m} + \sum_p N_{PCS,p} \times c_{PCS,p}$

式中 $c$ 为各设备单台价格（万元/台），$C_{max}$ 为所有可行方案中的最大投资。

#### (4) 稳定性评分（20分）

$$S_{stability} = S_{reserve} + S_{ESS} + S_{diversity}$$

- 备用容量评分：$S_{reserve} = 8 \times f_{reserve}(R_{cap})$
- 储能调节评分：$S_{ESS} = 7 \times f_{ESS}(\eta_{util})$
- 能源多样性评分：$S_{diversity} = 5 \times \left(1 - \frac{\sigma_{energy}}{\sigma_{max}}\right)$

---

## 二、约束条件函数

### 2.1 功率平衡约束

**实时功率平衡（软约束，允许缺电）：**

$$g_1(t): P_{wind}(t) + P_{solar}(t) + P_{bio}(t) + P_{dis}(t) - P_{ch}(t) + P_{deficit}(t) = P_{load}(t)$$

$$\forall t \in [1, 8760]$$

式中：
- $P_{wind}(t)$ —— t时刻风电功率，kW
- $P_{solar}(t)$ —— t时刻光伏功率（已含逆变器效率），kW
- $P_{bio}(t)$ —— t时刻生物质功率，kW
- $P_{dis}(t)$ —— t时刻储能放电功率，kW
- $P_{ch}(t)$ —— t时刻储能充电功率，kW
- $P_{deficit}(t)$ —— t时刻缺电功率，kW（$P_{deficit}(t) \geq 0$）
- $P_{load}(t)$ —— t时刻负荷需求，kW

### 2.2 能量平衡约束

$$g_2: E_{wind} + E_{solar} + E_{bio} + E_{dis} - E_{ch} \geq E_{load} \times (1 - LPSP_{max})$$

式中：
- $E_{wind}, E_{solar}, E_{bio}$ —— 各能源年发电量，kWh
- $E_{dis}, E_{ch}$ —— 储能年放电量、充电量，kWh
- $E_{load}$ —— 年负荷需求，kWh
- $LPSP_{max}$ —— 最大允许缺电率，一般取0.05

### 2.3 能源占比约束（修正）

**重要修正**：由于风能和光能存在间歇性，为保证供电可靠性，总装机容量需大于负荷需求，因此能源占比之和应**大于等于1**。

$$g_3: k_{wind} + k_{solar} + k_{bio} \geq 1$$

**各能源占比定义：**

$$k_{wind} = \frac{E_{wind}}{E_{load}}, \quad k_{solar} = \frac{E_{solar}}{E_{load}}, \quad k_{bio} = \frac{E_{bio}}{E_{load}}$$

**说明**：
- 当 $k_{wind} + k_{solar} + k_{bio} > 1$ 时，表示系统存在弃电或储能充电
- 当 $k_{wind} + k_{solar} + k_{bio} = 1$ 时，表示发电量恰好等于负荷需求（理想情况）
- 实际系统中，考虑到风光的间歇性，通常需要 $k_{wind} + k_{solar} + k_{bio} \geq 1.1 \sim 1.3$

**各能源占比范围约束：**

$$g_4: k_{wind,min} \leq k_{wind} \leq k_{wind,max}$$

$$g_5: k_{solar,min} \leq k_{solar} \leq k_{solar,max}$$

$$g_6: k_{bio,min} \leq k_{bio} \leq k_{bio,max}$$

**不同区域占比范围参考：**

| 区域类型 | $k_{wind}$ | $k_{solar}$ | $k_{bio}$ | 总和范围 |
|---------|-----------|------------|----------|---------|
| 工业区 | [0.25, 0.40] | [0.50, 0.70] | [0.15, 0.30] | [1.1, 1.4] |
| 居民区 | [0.20, 0.35] | [0.55, 0.75] | [0.10, 0.25] | [1.1, 1.35] |
| 山地区 | [0.45, 0.60] | [0.40, 0.55] | [0.10, 0.20] | [1.15, 1.35] |
| 农业区 | [0.30, 0.45] | [0.45, 0.60] | [0.20, 0.35] | [1.15, 1.4] |
| 林业区 | [0.05, 0.15] | [0.65, 0.85] | [0.25, 0.40] | [1.1, 1.4] |

### 2.4 设备容量约束

**风电容量：**

$$g_7: P_{wind} = \sum_{i=1}^{n} N_{wind,i} \times P_{wind,rated,i}$$

$$N_{wind,i} \geq 0, \quad N_{wind,i} \in \mathbb{Z}$$

**光伏容量：**

$$g_8: P_{solar} = \sum_{j=1}^{m} N_{solar,j} \times P_{solar,rated,j}$$

$$N_{solar,j} \geq 0, \quad N_{solar,j} \in \mathbb{Z}$$

**生物质容量：**

$$g_9: P_{bio} = \sum_{k=1}^{p} N_{bio,k} \times P_{bio,rated,k}$$

$$N_{bio,k} \geq 0, \quad N_{bio,k} \in \mathbb{Z}$$

**储能容量：**

$$g_{10}: E_{ESS} = \sum_{m=1}^{q} N_{batt,m} \times E_{batt,m}$$

$$N_{batt,m} \geq 0, \quad N_{batt,m} \in \mathbb{Z}$$

### 2.5 逆变器配置约束

**逆变器容量匹配：**

$$g_{11}: P_{inv} = P_{solar,DC} \times k_{inv}$$

$$g_{12}: 0.8 \leq k_{inv} \leq 1.2$$

式中：
- $P_{inv}$ —— 逆变器总容量，kW
- $P_{solar,DC}$ —— 光伏组件直流侧总功率，kW
- $k_{inv}$ —— 容配比

**逆变器数量约束：**

$$g_{13}: P_{inv} = \sum_{q=1}^{r} N_{inv,q} \times P_{inv,rated,q}$$

$$N_{inv,q} \geq 0, \quad N_{inv,q} \in \mathbb{Z}$$

### 2.6 PCS配置约束

**PCS功率匹配：**

$$g_{14}: P_{PCS} \geq \max(P_{ch,max}, P_{dis,max})$$

式中：
- $P_{ch,max} = \frac{E_{ESS}}{T_{ch}} \times \frac{1}{\eta_{ch}}$ —— 最大充电功率
- $P_{dis,max} = \frac{E_{ESS} \times DOD}{T_{dis}} \times \eta_{dis}$ —— 最大放电功率

**PCS数量约束：**

$$g_{15}: P_{PCS} = \sum_{p=1}^{s} N_{PCS,p} \times P_{PCS,rated,p}$$

$$N_{PCS,p} \geq 0, \quad N_{PCS,p} \in \mathbb{Z}$$

### 2.7 储能运行约束

**SOC约束：**

$$g_{16}: SOC_{min} \leq SOC(t) \leq SOC_{max}, \quad \forall t$$

$$SOC_{min} = 0.10, \quad SOC_{max} = 0.95$$

**SOC动态方程：**

$$SOC(t+1) = SOC(t) + \frac{P_{ch}(t) \times \eta_{ch} - P_{dis}(t) / \eta_{dis}}{E_{ESS}} \times \Delta t$$

**充放电互斥约束：**

$$g_{17}: P_{ch}(t) \times P_{dis}(t) = 0, \quad \forall t$$

**充放电时长约束：**

$$g_{18}: 2 \leq T_{ch} \leq 4$$ （充电时长，小时）

$$g_{19}: 3 \leq T_{dis} \leq 5$$ （放电时长，小时）

### 2.8 电压匹配约束

$$g_{20}: V_{batt,min} \leq V_{PCS,input,min}$$

$$g_{21}: V_{batt,max} \geq V_{PCS,input,max}$$

### 2.9 资源约束

**场地约束（光伏）：**

$$g_{22}: \sum_{j=1}^{m} N_{solar,j} \times A_{solar,j} \leq A_{available}$$

式中：
- $A_{solar,j}$ —— 第j种光伏组件占地面积，m²
- $A_{available}$ —— 可用场地面积，m²

**燃料约束（生物质）：**

$$g_{23}: M_{bio,annual} \leq M_{available}$$

式中：
- $M_{bio,annual} = \frac{E_{bio,annual}}{Q_{net,ar} \times \eta_{bio}}$ —— 年燃料消耗量，kg
- $M_{available}$ —— 年可用燃料量，kg

### 2.10 运行时长约束

$$g_{24}: 6000 \leq T_{wind} \leq 8000$$ （风机年运行小时数）

$$g_{25}: 6000 \leq T_{bio} \leq 8000$$ （生物质年运行小时数）

### 2.11 整数约束

$$g_{26}: N_{wind,i}, N_{solar,j}, N_{bio,k}, N_{batt,m}, N_{PCS,p}, N_{inv,q} \geq 0, \quad \in \mathbb{Z}$$

---

## 三、约束条件汇总表（简化版）

根据实际需求，删除了场地约束和运行时长约束，保留21条核心约束：

| 编号 | 约束类型 | 约束表达式 | 说明 |
|------|---------|-----------|------|
| $g_1$ | 功率平衡 | $P_{wind}(t) + P_{solar}(t) + P_{bio}(t) + P_{dis}(t) - P_{ch}(t) + P_{deficit}(t) = P_{load}(t)$ | 每时刻，允许缺电 |
| $g_2$ | 能量平衡 | $E_{wind} + E_{solar} + E_{bio} + E_{dis} - E_{ch} \geq E_{load} \times (1-LPSP_{max})$ | 年度满足 |
| $g_3$ | 能源占比总和 | $k_{wind} + k_{solar} + k_{bio} \geq 1$ | **修正：允许大于1** |
| $g_4$ | 风电占比 | $k_{wind,min} \leq k_{wind} \leq k_{wind,max}$ | 根据区域 |
| $g_5$ | 光伏占比 | $k_{solar,min} \leq k_{solar} \leq k_{solar,max}$ | 根据区域 |
| $g_6$ | 生物质占比 | $k_{bio,min} \leq k_{bio} \leq k_{bio,max}$ | 根据区域 |
| $g_7$ | 风电容量 | $P_{wind} = \sum_i N_{wind,i} \times P_{wind,i}$ | 设备配置 |
| $g_8$ | 光伏容量 | $P_{solar} = \sum_j N_{solar,j} \times P_{solar,j}$ | 设备配置 |
| $g_9$ | 生物质容量 | $P_{bio} = \sum_k N_{bio,k} \times P_{bio,k}$ | 设备配置 |
| $g_{10}$ | 储能容量 | $E_{ESS} = \sum_m N_{batt,m} \times E_{batt,m}$ | 设备配置 |
| $g_{11}$ | 逆变器容量 | $P_{inv} = P_{solar,DC} \times k_{inv}$ | 容配比计算 |
| $g_{12}$ | 容配比范围 | $0.8 \leq k_{inv} \leq 1.2$ | 逆变器匹配 |
| $g_{13}$ | 逆变器数量 | $P_{inv} = \sum_q N_{inv,q} \times P_{inv,q}$ | 整数约束 |
| $g_{14}$ | PCS功率 | $P_{PCS} \geq \max(P_{ch,max}, P_{dis,max})$ | 功率匹配 |
| $g_{15}$ | PCS数量 | $P_{PCS} = \sum_p N_{PCS,p} \times P_{PCS,p}$ | 整数约束 |
| $g_{16}$ | SOC约束 | $0.10 \leq SOC(t) \leq 0.95$ | 储能状态 |
| $g_{17}$ | 充放电互斥 | $P_{ch}(t) \times P_{dis}(t) = 0$ | 不能同时 |
| $g_{18}$ | 充电时长 | $2 \leq T_{ch} \leq 4$ | 小时 |
| $g_{19}$ | 放电时长 | $3 \leq T_{dis} \leq 5$ | 小时 |
| $g_{20}$ | 电压下限 | $V_{batt,min} \leq V_{PCS,input,min}$ | 电池-PCS匹配 |
| $g_{21}$ | 电压上限 | $V_{batt,max} \geq V_{PCS,input,max}$ | 电池-PCS匹配 |
| $g_{22}$ | 燃料约束 | $M_{bio,annual} \leq M_{available}$ | 生物质资源 |
| $g_{23}$ | 整数约束 | $N_{wind,i}, N_{solar,j}, N_{bio,k}, N_{batt,m}, N_{PCS,p}, N_{inv,q} \geq 0, \in \mathbb{Z}$ | 设备数量 |

**已删除的约束：**
- ~~场地约束~~（$\sum_j N_{solar,j} \times A_j \leq A_{available}$）
- ~~风机运行时长约束~~（$6000 \leq T_{wind} \leq 8000$）
- ~~生物质运行时长约束~~（$6000 \leq T_{bio} \leq 8000$）

---

## 四、决策变量汇总

### 4.1 整数变量（设备数量）

| 变量 | 含义 | 取值范围 |
|------|------|---------|
| $N_{wind,i}$ | 第i种风机数量 | $\geq 0$，整数 |
| $N_{solar,j}$ | 第j种光伏组件数量 | $\geq 0$，整数 |
| $N_{bio,k}$ | 第k种生物质机组数量 | $\geq 0$，整数 |
| $N_{batt,m}$ | 第m种电池组数量 | $\geq 0$，整数 |
| $N_{PCS,p}$ | 第p种PCS数量 | $\geq 0$，整数 |
| $N_{inv,q}$ | 第q种逆变器数量 | $\geq 0$，整数 |

### 4.2 连续变量（运行参数）

| 变量 | 含义 | 取值范围 |
|------|------|---------|
| $T_{wind}$ | 风机年运行小时数 | [6000, 8000] h |
| $T_{bio}$ | 生物质年运行小时数 | [6000, 8000] h |
| $T_{ch}$ | 储能充电时长 | [2, 4] h |
| $T_{dis}$ | 储能放电时长 | [3, 5] h |
| $k_{wind}$ | 风电占比 | 根据区域 |
| $k_{solar}$ | 光伏占比 | 根据区域 |
| $k_{bio}$ | 生物质占比 | 根据区域 |
| $k_{inv}$ | 逆变器容配比 | [0.8, 1.2] |

### 4.3 状态变量（8760小时）

| 变量 | 含义 |
|------|------|
| $P_{wind}(t)$ | t时刻风电功率 |
| $P_{solar}(t)$ | t时刻光伏功率 |
| $P_{bio}(t)$ | t时刻生物质功率 |
| $P_{ch}(t)$ | t时刻储能充电功率 |
| $P_{dis}(t)$ | t时刻储能放电功率 |
| $P_{deficit}(t)$ | t时刻缺电功率 |
| $SOC(t)$ | t时刻储能荷电状态 |

---

## 五、关键修正说明

### 5.1 能源占比约束修正

**原约束（错误）：**
$$k_{wind} + k_{solar} + k_{bio} = 1$$

**修正后约束：**
$$k_{wind} + k_{solar} + k_{bio} \geq 1$$

**修正原因：**

1. **间歇性问题**：风能和光能具有间歇性和波动性，在无风或阴天时无法发电，需要其他能源补充
2. **供电可靠性**：为保证系统在各种工况下都能满足负荷需求，总装机容量需大于负荷需求
3. **弃电与储能**：当能源占比之和大于1时，多余电量可通过储能系统存储或弃电处理
4. **实际工程经验**：实际混合能源系统中，装机冗余度通常为10%-30%

### 5.2 能源占比定义修正

**修正后定义：**

$$k_{wind} = \frac{E_{wind}}{E_{load}}$$

$$k_{solar} = \frac{E_{solar}}{E_{load}}$$

$$k_{bio} = \frac{E_{bio}}{E_{load}}$$

**说明**：各能源占比以负荷需求为基准，而非以总发电量为基准，这样更能反映系统的供电能力。

### 5.3 功率平衡约束修正

**修正后约束：**

引入缺电功率变量 $P_{deficit}(t)$，将硬约束改为软约束：

$$P_{wind}(t) + P_{solar}(t) + P_{bio}(t) + P_{dis}(t) - P_{ch}(t) + P_{deficit}(t) = P_{load}(t)$$

$$P_{deficit}(t) \geq 0$$

**说明**：允许系统在极端工况下存在缺电，通过缺电率（LPSP）指标评估系统可靠性。

---

## 六、优化模型数学表达

### 6.1 完整优化模型

$$\begin{aligned}
\max \quad & S_{total} = S_{condition} + S_{equipment} + S_{economy} + S_{stability} \\
\text{s.t.} \quad & g_1(t): P_{wind}(t) + P_{solar}(t) + P_{bio}(t) + P_{dis}(t) - P_{ch}(t) + P_{deficit}(t) = P_{load}(t), \quad \forall t \\
& g_2: E_{wind} + E_{solar} + E_{bio} + E_{dis} - E_{ch} \geq E_{load} \times (1 - LPSP_{max}) \\
& g_3: k_{wind} + k_{solar} + k_{bio} \geq 1 \\
& g_4 \sim g_6: k_{i,min} \leq k_i \leq k_{i,max}, \quad i \in \{wind, solar, bio\} \\
& g_7 \sim g_{10}: \text{设备容量约束} \\
& g_{11} \sim g_{15}: \text{逆变器与PCS配置约束} \\
& g_{16} \sim g_{19}: \text{储能运行约束} \\
& g_{20} \sim g_{21}: \text{电压匹配约束} \\
& g_{22} \sim g_{23}: \text{资源约束} \\
& g_{24} \sim g_{25}: \text{运行时长约束} \\
& g_{26}: \text{整数约束}
\end{aligned}$$

---

**文档版本**：v1.0  
**编制日期**：2026年1月6日  
**修正内容**：能源占比约束由"等于1"修正为"大于等于1"
