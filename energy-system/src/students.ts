// 学生名册数据 - 从点名册.xlsx导入
// 格式: { 学号: 姓名 }

export const studentList: Record<string, string> = {
  "20222973": "巨哲",
  "20223013": "谌思成",
  "20224519": "连之栋",
  "20225485": "张郭凯文",
  "20230015": "杨成林",
  "20232481": "刘念",
  "20232597": "唐瑞",
  "20234680": "罗人恺",
  "20234695": "丁浩",
  "20234700": "赵艺涵",
  "20234732": "戴涵宇",
  "20234769": "李佳益",
  "20234784": "缪炘芮",
  "20234789": "李怡葶",
  "20234818": "巫玲玉",
  "20234819": "李东晨",
  "20234830": "孟凡博",
  "20234833": "晏杨",
  "20234838": "叶锦霖",
  "20234840": "胡显勇",
  "20234841": "艾宇枝",
  "20234843": "范可怡",
  "20234861": "孙肇锋",
  "20234862": "余知行",
  "20234872": "侯临双",
  "20234873": "胡继敏",
  "20234885": "谭淏",
  "20234886": "游子琪",
  "20234888": "康玉玺",
  "20234901": "刘航羽",
  "20234906": "蔡云天",
  "20234920": "朱瀚文",
  "20234932": "邱虔",
  "20234949": "马宇轩",
  "20234964": "曾胤霖",
  "20234981": "赵炘垚",
  "20234992": "王茜贝",
  "20234997": "陶真",
  "20235003": "曲博超",
  "20235011": "郑雁菘",
  "20235013": "刘丰",
  "20235038": "李佳状",
  "20235046": "尚煜晴",
  "20235059": "杨又权",
  "20235061": "李明昊",
  "20235079": "庞世杰",
  "20235089": "伍峻",
  "20235091": "袁煜博",
  "20235097": "刘文韬",
  "20235098": "陈凌彬",
  "20235099": "穆亭羽",
  "20235102": "熊才婷",
  "11": "11",
};

// 学生-区域固定映射表
// 基于原取模算法，重复区域的学生分配到空闲区域
// 原算法: (学号后4位 % 52) + 1
export const studentRegionMap: Record<string, number> = {
  // 原算法结果保持不变的（无冲突）
  "20235097": 2,   // 刘文韬 (5097%52+1=2)
  "20235099": 4,   // 穆亭羽 (5099%52+1=4)
  "20234840": 5,   // 胡显勇 (4840%52+1=5)
  "20235102": 7,   // 熊才婷 (5102%52+1=7)
  "20234843": 8,   // 范可怡 (4843%52+1=8)
  "20235003": 12,  // 曲博超 (5003%52+1=12)
  "20234901": 14,  // 刘航羽 (4901%52+1=14)
  "20234906": 19,  // 蔡云天 (4906%52+1=19)
  "20235011": 20,  // 郑雁菘 (5011%52+1=20)
  "20234700": 21,  // 赵艺涵 (4700%52+1=21)
  "20235013": 22,  // 刘丰 (5013%52+1=22)
  "20234964": 25,  // 曾胤霖 (4964%52+1=25)
  "20234862": 27,  // 余知行 (4862%52+1=27)
  "20234920": 33,  // 朱瀚文 (4920%52+1=33)
  "20234818": 35,  // 巫玲玉 (4818%52+1=35)
  "20234872": 37,  // 侯临双 (4872%52+1=37)
  "20234981": 42,  // 赵炘垚 (4981%52+1=42)
  "20234932": 45,  // 邱虔 (4932%52+1=45)
  "20235089": 46,  // 伍峻 (5089%52+1=46)
  "20234886": 51,  // 游子琪 (4886%52+1=51)
  "20235061": 18,  // 李明昊 (5061%52+1=18)
  
  // 原算法区域1的5人，保留1人，其他分配到空闲区域
  "20234680": 1,   // 罗人恺 (4680%52+1=1) - 保留
  "20234732": 9,   // 戴涵宇 (4732%52+1=1) -> 9
  "20234784": 11,  // 缪炘芮 (4784%52+1=1) -> 11
  "20234992": 15,  // 王茜贝 (4992%52+1=1) -> 15
  
  // 原算法区域3的3人，保留1人，其他分配到空闲区域
  "20234838": 3,   // 叶锦霖 (4838%52+1=3) - 保留
  "20235046": 17,  // 尚煜晴 (5046%52+1=3) -> 17
  "20235098": 23,  // 陈凌彬 (5098%52+1=3) -> 23
  
  // 原算法区域6的3人，保留1人，其他分配到空闲区域
  "20234789": 6,   // 李怡葶 (4789%52+1=6) - 保留
  "20234841": 24,  // 艾宇枝 (4841%52+1=6) -> 24
  "20234997": 28,  // 陶真 (4997%52+1=6) -> 28
  
  // 原算法区域10的2人，保留1人，其他分配到空闲区域
  "20222973": 10,  // 巨哲 (2973%52+1=10) - 保留
  "20234949": 29,  // 马宇轩 (4949%52+1=10) -> 29
  
  // 原算法区域16的3人，保留1人，其他分配到空闲区域
  "20230015": 16,  // 杨成林 (15%52+1=16) - 保留
  "20234695": 30,  // 丁浩 (4695%52+1=16) -> 30
  "20235059": 31,  // 杨又权 (5059%52+1=16) -> 31
  
  // 原算法区域26的2人，保留1人，其他分配到空闲区域
  "20225485": 26,  // 张郭凯文 (5485%52+1=26) - 保留
  "20234861": 32,  // 孙肇锋 (4861%52+1=26) -> 32
  
  // 原算法区域36的2人，保留1人，其他分配到空闲区域
  "20234819": 36,  // 李东晨 (4819%52+1=36) - 保留
  "20235079": 34,  // 庞世杰 (5079%52+1=36) -> 34
  
  // 原算法区域38的3人，保留1人，其他分配到空闲区域
  "20232481": 38,  // 刘念 (2481%52+1=38) - 保留
  "20234769": 39,  // 李佳益 (4769%52+1=38) -> 39
  "20234873": 40,  // 胡继敏 (4873%52+1=38) -> 40
  
  // 原算法区域47的2人，保留李佳状，其他分配到空闲区域
  "20235038": 47,  // 李佳状 (5038%52+1=47) - 保留（按要求）
  "20234830": 41,  // 孟凡博 (4830%52+1=47) -> 41
  
  // 原算法区域48的2人，保留1人，其他分配到空闲区域
  "20224519": 48,  // 连之栋 (4519%52+1=48) - 保留
  "20235091": 43,  // 袁煜博 (5091%52+1=48) -> 43
  
  // 原算法区域50的4人，保留1人，其他分配到空闲区域
  "20223013": 50,  // 谌思成 (3013%52+1=50) - 保留
  "20234888": 44,  // 康玉玺 (2597%52+1=50) -> 44
  "20234833": 49,  // 晏杨 (4833%52+1=50) -> 49
  "20234885": 52,  // 谭淏 (4885%52+1=50) -> 52
  
  // 测试账号
  "11": 53,        // 测试账号 -> 测试区
};

// 获取学生分配的区域ID
export const getStudentRegion = (studentId: string): number => {
  const trimmedId = studentId.trim();
  return studentRegionMap[trimmedId] || 1; // 默认返回区域1
};

// 验证学生信息
export const validateStudent = (studentId: string, name: string): boolean => {
  const trimmedId = studentId.trim();
  const trimmedName = name.trim();
  return studentList[trimmedId] === trimmedName;
};

// 获取学生姓名
export const getStudentName = (studentId: string): string | null => {
  return studentList[studentId.trim()] || null;
};
