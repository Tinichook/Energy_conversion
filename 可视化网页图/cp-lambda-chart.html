<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cp-Î» é£èƒ½åˆ©ç”¨ç³»æ•°æ›²çº¿</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        .chart-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        canvas {
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .info-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        .info-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #007bff;
        }
        .info-box h3 {
            color: #007bff;
            margin-bottom: 15px;
        }
        .info-box p {
            margin: 8px 0;
            color: #555;
        }
        .info-box strong {
            color: #d63384;
        }
        .formula {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Times New Roman', serif;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background: #007bff;
            color: white;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        .highlight {
            background: #d4edda !important;
            font-weight: bold;
        }
        .controls {
            margin: 20px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
        .controls label {
            margin-right: 10px;
            font-weight: bold;
        }
        .controls select {
            padding: 8px 15px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
        }
        #optimalInfo {
            margin-top: 10px;
            padding: 10px;
            background: #d1ecf1;
            border-radius: 5px;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cp-Î» é£èƒ½åˆ©ç”¨ç³»æ•°ä¸å¶å°–é€Ÿæ¯”å…³ç³»å›¾</h1>
        
        <div class="chart-container">
            <canvas id="cpChart" width="900" height="550"></canvas>
        </div>
        
        <div class="controls">
            <label>é€‰æ‹©æ¡¨è·è§’ Î²ï¼š</label>
            <select id="betaSelect" onchange="updateOptimalInfo()">
                <option value="0">0Â°</option>
                <option value="2">2Â°</option>
                <option value="4">4Â°</option>
                <option value="6">6Â°</option>
                <option value="8">8Â°</option>
                <option value="10">10Â°</option>
                <option value="12">12Â°</option>
                <option value="14">14Â°</option>
                <option value="16">16Â°</option>
                <option value="18">18Â°</option>
                <option value="20">20Â°</option>
            </select>
            <div id="optimalInfo"></div>
        </div>
        
        <div class="info-panel">
            <div class="info-box">
                <h3>ğŸ“ è®¡ç®—å…¬å¼</h3>
                <div class="formula">
                    Cp = câ‚(câ‚‚/Î»áµ¢ - câ‚ƒÎ² - câ‚„)e^(-câ‚…/Î»áµ¢) + câ‚†Î»
                </div>
                <div class="formula">
                    Î»áµ¢ = 1 / (1/(Î»+0.08Î²) - 0.035/(Î²Â³+1))
                </div>
                <p><strong>ç³»æ•°ï¼š</strong></p>
                <p>câ‚ = 0.5176, câ‚‚ = 116, câ‚ƒ = 0.4</p>
                <p>câ‚„ = 5, câ‚… = 21, câ‚† = 0.0068</p>
            </div>
            
            <div class="info-box">
                <h3>ğŸ¯ æœ€ä¼˜å·¥ä½œç‚¹ï¼ˆÎ²=0Â°ï¼‰</h3>
                <p>æœ€ä½³å¶å°–é€Ÿæ¯”ï¼š<strong id="optLambda">Î»_opt = 8.10</strong></p>
                <p>æœ€å¤§é£èƒ½åˆ©ç”¨ç³»æ•°ï¼š<strong id="optCp">Cp_max = 0.4800</strong></p>
                <p>è´èŒ¨æé™ï¼šCp_Berta = 0.593 (59.3%)</p>
                <p>å®é™…æ•ˆç‡ï¼š<strong id="efficiency">81.0%</strong> è´èŒ¨æé™</p>
            </div>
        </div>
        
        <h3 style="margin-top: 30px; color: #333;">ğŸ“Š ä¸åŒæ¡¨è·è§’ä¸‹çš„æœ€ä¼˜å‚æ•°</h3>
        <table id="dataTable">
            <thead>
                <tr>
                    <th>æ¡¨è·è§’ Î² (Â°)</th>
                    <th>æœ€ä½³å¶å°–é€Ÿæ¯” Î»_opt</th>
                    <th>æœ€å¤§ Cp</th>
                    <th>ç›¸å¯¹è´èŒ¨æé™ (%)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        // Cp-Î» è®¡ç®—å‚æ•°
        const CP_PARAMS = {
            c1: 0.5176,
            c2: 116,
            c3: 0.4,
            c4: 5,
            c5: 21,
            c6: 0.0068
        };
        
        const BETZ_LIMIT = 0.593;
        
        // è®¡ç®—é£èƒ½åˆ©ç”¨ç³»æ•° Cp
        function calculateCp(lambda, beta) {
            const { c1, c2, c3, c4, c5, c6 } = CP_PARAMS;
            const lambdaI = 1 / (1 / (lambda + 0.08 * beta) - 0.035 / (Math.pow(beta, 3) + 1));
            const Cp = c1 * ((c2 / lambdaI) - c3 * beta - c4) * Math.exp(-c5 / lambdaI) + c6 * lambda;
            return Cp;
        }
        
        // æ‰¾åˆ°æœ€å¤§Cpç‚¹
        function findOptimalPoint(beta) {
            let maxCp = -Infinity;
            let optLambda = 0;
            
            for (let lambda = 0.1; lambda <= 18; lambda += 0.01) {
                const cp = calculateCp(lambda, beta);
                if (cp > maxCp) {
                    maxCp = cp;
                    optLambda = lambda;
                }
            }
            
            return { lambda: optLambda, cp: maxCp };
        }
        
        // é¢œè‰²æ•°ç»„
        const COLORS = [
            '#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd',
            '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf', '#aec7e8'
        ];
        
        // ç»˜åˆ¶å›¾è¡¨
        function drawChart() {
            const canvas = document.getElementById('cpChart');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);
            
            // ç»˜å›¾åŒºåŸŸ
            const margin = { top: 50, right: 130, bottom: 70, left: 80 };
            const plotWidth = width - margin.left - margin.right;
            const plotHeight = height - margin.top - margin.bottom;
            
            // åæ ‡è½´èŒƒå›´
            const xMin = 0, xMax = 18;
            const yMin = -1.2, yMax = 0.6;
            
            // åæ ‡è½¬æ¢å‡½æ•°
            const toCanvasX = (x) => margin.left + (x - xMin) / (xMax - xMin) * plotWidth;
            const toCanvasY = (y) => margin.top + (yMax - y) / (yMax - yMin) * plotHeight;
            
            // ç»˜åˆ¶ç½‘æ ¼
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            
            for (let x = 0; x <= 18; x += 2) {
                ctx.beginPath();
                ctx.moveTo(toCanvasX(x), margin.top);
                ctx.lineTo(toCanvasX(x), height - margin.bottom);
                ctx.stroke();
            }
            
            for (let y = -1.2; y <= 0.6; y += 0.2) {
                ctx.beginPath();
                ctx.moveTo(margin.left, toCanvasY(y));
                ctx.lineTo(width - margin.right, toCanvasY(y));
                ctx.stroke();
            }
            
            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            
            // Xè½´ï¼ˆy=0å¤„ï¼‰
            ctx.beginPath();
            ctx.moveTo(margin.left, toCanvasY(0));
            ctx.lineTo(width - margin.right, toCanvasY(0));
            ctx.stroke();
            
            // Yè½´
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.stroke();
            
            // ç»˜åˆ¶åˆ»åº¦å’Œæ ‡ç­¾
            ctx.fillStyle = '#000000';
            ctx.font = '13px Arial';
            ctx.textAlign = 'center';
            
            for (let x = 0; x <= 18; x += 2) {
                ctx.fillText(x.toString(), toCanvasX(x), height - margin.bottom + 25);
            }
            
            ctx.textAlign = 'right';
            for (let y = -1.2; y <= 0.6; y += 0.2) {
                ctx.fillText(y.toFixed(1), margin.left - 12, toCanvasY(y) + 5);
            }
            
            // è½´æ ‡ç­¾
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Î» (å¶å°–é€Ÿæ¯”)', width / 2, height - 20);
            
            ctx.save();
            ctx.translate(25, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Cp (é£èƒ½åˆ©ç”¨ç³»æ•°)', 0, 0);
            ctx.restore();
            
            // æ ‡é¢˜
            ctx.font = 'bold 18px Microsoft YaHei';
            ctx.fillText('Cp-Î» å…³ç³»æ›²çº¿', width / 2, 30);
            
            // ç»˜åˆ¶ä¸åŒæ¡¨è·è§’çš„æ›²çº¿
            const betaValues = [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20];
            
            betaValues.forEach((beta, index) => {
                ctx.strokeStyle = COLORS[index % COLORS.length];
                ctx.lineWidth = beta === 0 ? 2.5 : 1.5;
                ctx.beginPath();
                
                let started = false;
                for (let lambda = 0.1; lambda <= 18; lambda += 0.1) {
                    const cp = calculateCp(lambda, beta);
                    const x = toCanvasX(lambda);
                    const y = toCanvasY(cp);
                    
                    if (cp >= yMin && cp <= yMax) {
                        if (!started) {
                            ctx.moveTo(x, y);
                            started = true;
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                }
                ctx.stroke();
            });
            
            // ç»˜åˆ¶å›¾ä¾‹
            ctx.font = '12px Arial';
            ctx.textAlign = 'left';
            const legendX = width - margin.right + 15;
            let legendY = margin.top + 20;
            
            ctx.fillStyle = '#333';
            ctx.font = 'bold 13px Arial';
            ctx.fillText('æ¡¨è·è§’ Î²', legendX, legendY);
            legendY += 20;
            
            ctx.font = '12px Arial';
            betaValues.forEach((beta, index) => {
                ctx.fillStyle = COLORS[index % COLORS.length];
                ctx.fillRect(legendX, legendY - 8, 25, 3);
                ctx.fillStyle = '#000000';
                ctx.fillText(`${beta}Â°`, legendX + 32, legendY);
                legendY += 20;
            });
            
            // æ ‡è®°æœ€ä¼˜ç‚¹ï¼ˆÎ²=0æ—¶ï¼‰
            const optimal = findOptimalPoint(0);
            const optX = toCanvasX(optimal.lambda);
            const optY = toCanvasY(optimal.cp);
            
            // ç»˜åˆ¶æ ‡è®°ç‚¹
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.arc(optX, optY, 7, 0, 2 * Math.PI);
            ctx.fill();
            
            ctx.strokeStyle = '#ff0000';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(optX, optY, 12, 0, 2 * Math.PI);
            ctx.stroke();
            
            // æ ‡æ³¨æ–‡å­—
            ctx.fillStyle = '#cc0000';
            ctx.font = 'bold 13px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`X: ${optimal.lambda.toFixed(2)}`, optX + 18, optY - 8);
            ctx.fillText(`Y: ${optimal.cp.toFixed(4)}`, optX + 18, optY + 10);
            
            // æ›´æ–°é¡µé¢æ˜¾ç¤º
            document.getElementById('optLambda').textContent = `Î»_opt = ${optimal.lambda.toFixed(2)}`;
            document.getElementById('optCp').textContent = `Cp_max = ${optimal.cp.toFixed(4)}`;
            document.getElementById('efficiency').textContent = `${(optimal.cp / BETZ_LIMIT * 100).toFixed(1)}%`;
        }
        
        // æ›´æ–°æœ€ä¼˜ç‚¹ä¿¡æ¯
        function updateOptimalInfo() {
            const beta = parseInt(document.getElementById('betaSelect').value);
            const optimal = findOptimalPoint(beta);
            
            document.getElementById('optimalInfo').innerHTML = `
                <strong>Î² = ${beta}Â° æ—¶ï¼š</strong>
                æœ€ä½³å¶å°–é€Ÿæ¯” Î»_opt = ${optimal.lambda.toFixed(2)}ï¼Œ
                æœ€å¤§ Cp = ${optimal.cp.toFixed(4)}ï¼Œ
                ç›¸å¯¹è´èŒ¨æé™ ${(optimal.cp / BETZ_LIMIT * 100).toFixed(1)}%
            `;
        }
        
        // å¡«å……æ•°æ®è¡¨æ ¼
        function fillDataTable() {
            const tbody = document.querySelector('#dataTable tbody');
            const betaValues = [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20];
            
            betaValues.forEach(beta => {
                const optimal = findOptimalPoint(beta);
                const efficiency = (optimal.cp / BETZ_LIMIT * 100).toFixed(1);
                
                const row = document.createElement('tr');
                if (beta === 0) row.className = 'highlight';
                
                row.innerHTML = `
                    <td>${beta}</td>
                    <td>${optimal.lambda.toFixed(2)}</td>
                    <td>${optimal.cp.toFixed(4)}</td>
                    <td>${efficiency}%</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // åˆå§‹åŒ–
        window.onload = function() {
            drawChart();
            updateOptimalInfo();
            fillDataTable();
        };
    </script>
</body>
</html>
